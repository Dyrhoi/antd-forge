---
title: useTable
description: Connect filter forms to data tables with type-safe queries and automatic state management.
sources:
  Ant Design - Table: https://ant.design/components/table
  TanStack Query: https://tanstack.com/query/latest
  useForm: /docs/hooks/useForm
---

<ExamplePreview src="examples/use-table-example.tsx" files={[{ path: "examples/mockdata/products.ts", name: "products.ts" }]} />

## Overview

`useTable` combines the power of `useForm` with [TanStack Query](https://tanstack.com/query/latest) to create a seamless connection between filter forms and data tables. It manages filter state, query execution, and table props automatically.

### Key Features

- **Built on useForm** - All type-safe form features from `useForm` are included
- **Automatic query management** - Filters are synced with TanStack Query
- **Type-safe data fetching** - Full type inference for filter values and query results
- **Built-in pagination** - Server-side pagination with automatic state management
- **Colocated query definitions** - Define query options separately with `createTableQueryOptions`

## Usage

{/* prettier-ignore */}
```tsx twoslash
import React from "react";

import { Form, Input, Button, Table } from "antd";
import { queryOptions } from "@tanstack/react-query";
import { z } from "zod";
import { useTable } from "@dyrhoi/antd-forge";

type User = {
  id: number;
  name: string;
};
declare function fetchUsers(filters: { search?: string }): Promise<{ items: User[]; count: number }>;

const schema = z.object({
  search: z.string().optional(),
});

function UsersTable() {
  const { formProps, FormItem, tableProps } = useTable({
    validator: schema,
    queryOptions: ({ filters, pagination }) =>
      //             ^?
      queryOptions({
        queryKey: ["users", filters],
        queryFn: () => fetchUsers(filters),
        select: (data) => ({ data: data.items, total: data.count }),
      }),
  });

  // `tableProps.dataSource` is fully typed as `User[]`
  const dataSourceType = tableProps.dataSource;
  //    ^?

  return (
    <div>
      <Form {...formProps} layout="inline">
        <FormItem name={["search"]} label="Search">
          <Input />
        </FormItem>
        <Button type="primary" htmlType="submit">
          Search
        </Button>
      </Form>

      <Table {...tableProps} columns={[
        {
          title: "ID",
          dataIndex: "id",
          key: "id",
        },
        {
          title: "Name",
          dataIndex: "name",
          key: "name",
        },
      ]} rowKey="id" />
    </div>
  );
}
```

{/* prettier-ignore-end */}

### Without TanStack Query

If you're not using TanStack Query, you can use the simpler `search` function instead.

```tsx
const { formProps, FormItem, tableProps } = useTable({
  validator: schema,
  search: async ({ filters, pagination }) => {
    const data = await fetchUsers(filters, pagination.current, pagination.pageSize);
    return { data: data.items, total: data.count };
  },
});
```

## Examples

### Default `queryOptions`

<ExamplePreview src="examples/use-table-example.tsx" files={[{ path: "examples/mockdata/products.ts", name: "products.ts" }]} />

### Basic without TanStack Query using `search`

<ExamplePreview src="examples/use-table-basic-example.tsx" files={[{ path: "examples/mockdata/users.ts", name: "users.ts" }]} />

## Pagination

`useTable` provides built-in server-side pagination. The `search` or `queryOptions` function receives pagination state, and `tableProps` automatically wires up the table's pagination UI.

### How It Works

1. Your search function receives `{ filters, pagination: { current, pageSize } }`
2. Return `{ data, total }` where `total` is the total count (not page count)
3. `tableProps.pagination` is automatically configured with the current state
4. Page resets to 1 when filters change or page size changes

### Custom Initial Values

```tsx
const { tableProps, pagination } = useTable({
  validator: schema,
  search: searchFn,
  pagination: {
    initial: {
      pageSize: 25,  // Default is 10
      current: 1,
    },
  },
});

// Read current pagination state
console.log(pagination.current, pagination.pageSize, pagination.total);
```

### Using Pagination in Queries

```tsx
const { tableProps } = useTable({
  validator: schema,
  queryOptions: ({ filters, pagination }) =>
    queryOptions({
      queryKey: ["users", filters, pagination],
      queryFn: () => fetchUsers({
        ...filters,
        page: pagination.current,
        limit: pagination.pageSize,
      }),
      select: (data) => ({ data: data.items, total: data.totalCount }),
    }),
});
```
